var express = require('express');var router = express.Router();var  formidable=require('formidable');var c= require('crypto');var bodyparser =  require('body-parser');var ejs=require('ejs');var fs=require('fs');var queryString=require('querystring');var multiparty = require('multiparty');var con=require('../../modules/index/mysql');//请求页面router.get('/', function(req, res, next) {    //判断权限    if(req.session.ids){        res.redirect('/');    }    //数据处理，以及网页请求    res.render('./index/reg', { jjj: 'Express'});});//请求注册router.post('/',function (req,res,next) {    var md5 = c.createHash('md5');    var zhang=req.body.zhang;    var mi=req.body.mi;    var imgurl=req.body.imgurl;    var name=req.body.name;    md5.update(mi);    var sign = md5.digest('hex');    con.query('insert into wuser (zhang,mi,name,imgurl) value(?,?,?,?)',[zhang,sign,name,imgurl],function (err,rul,files) {        if (err) throw err;        if (rul.affectedRows>0){            res.redirect('/login');            res.end();        }else{            res.redirect('/reg');            res.end();        }    });});module.exports = router;