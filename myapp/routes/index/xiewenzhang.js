var express = require('express');var router = express.Router();var con=require('../../modules/index/mysql');var ejs=require('ejs');router.get('/', function(req, res, next) {    //判断权限    if(!req.session.ids){        res.redirect('/login');    }    //数据处理，以及网页请求    res.render('./index/xiewenzhang', { title: 'Express' });});//请求添加文章router.post('/',function(req,res,next){    var title=req.body.title;    var clicknum=0;    var text=req.body.text;    var pid=req.body.pid;    var fenlei=req.body.fenlei;    var gunkai=req.body.gunkai;    var img=req.body.img;    img=img?img:'data1490627458757.jpg';    con.query('insert into context (title,text,clicknum,feilei,pid,public,img) value(?,?,?,?,?,?,?)',[title,text,clicknum,fenlei,pid,gunkai,img],function (err,rul,fields) {        if (err)throw err;        if(rul.affectedRows>0){            res.redirect('/user');        }else {            res.redirect('/xiewenzhang');        }    });});module.exports = router;