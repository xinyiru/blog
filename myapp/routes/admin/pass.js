var express = require('express');var router = express.Router();var con=require('../../modules/admin/mysql');var ejs=require('ejs');/* GET home page. */router.get('/', function(req, res, next) {    var id=req.session.hid;    con.query('select * from huser where id=?',[id],function(err,rul,fiels){        if(err)throw err;        //数据处理，以及网页请求        res.render('./admin/pass', { data : rul });    });});router.post('/',function(req,res,next){    var mi=req.body.mi;    var id=req.session.hid;    var newmi1=req.body.newmi1;    var newmi2=req.body.newmi2;    console.dir(req.body);    if(newmi1==newmi2){        con.query('select * from huser where mi=?',[mi],function(err,rul,fiels){            if (err)throw err;            if (rul.length>0){                con.query('update huser set mi=? where id=?',[newmi2,id],function (err,rul,fiels) {                    if (err)throw err;                    if(rul.affectedRows>0){                        res.redirect('/hpass');                    }else{                        res.redirect('/hpass');                    }                });            }else {                res.redirect('/hpass');            }        });    }else {        res.redirect('/hpass');    }});module.exports = router;